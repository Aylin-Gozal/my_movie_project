<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Movies</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Funnel+Display:wght@300..800&display=swap" rel="stylesheet">
</head>
<body>
<h1>Movies</h1>

<div th:if="${success}"
     style="color: green; font-weight: bold;">
  <p th:text="${success}"></p>
</div>


<div th:if="${error}"
     style="color: red; font-weight: bold; margin-bottom: 10px;">
  <p th:text="${error}"></p>
</div>


<a href="/movies/new" class="btn">Add Movie</a>

<form method="get" action="/movies">
  <a th:href="@{/movies(
  sortBy='title',
  direction=${direction == 'asc' ? 'desc' : 'asc'}
  )}">sort
  <span th:if="${sortBy == 'title'}"
        th:text="${direction == 'asc' ? '˄' : '˅'}">
    </span></a> <br>

  Searh by title:
  <input type="text" name="title" th:value="${title}" />

  Searh by genre:
  <input type="text" name="genre" th:value="${genre}" />

  <button type="submit">Search</button>
  <a href="/movies">Reset</a>
</form>


<br>

<table>
  <tr>
    <th>ID</th>
    <th>Title</th>
    <th>Genre</th>
    <th>Release Date</th>
    <th>Rating</th>
    <th>Duration</th>
  </tr>



  <tr th:each="movie : ${movies}">
    <td th:text="${movie.id}"></td>
    <td th:text="${movie.title}"></td>
    <td th:text="${movie.genre}"></td>
    <td th:text="${movie.releaseDate}"></td>
    <td th:text="${movie.rating}"></td>
    <td th:text="${movie.duration}"></td>
    <td>
      <a th:href="@{/movies/{id}/edit(id=${movie.id})}" class="edit">Edit</a>
      <form th:action= "@{/movies/{id}/delete(id=${movie.id})}" method="post" style="display:inline">
<!--        <button  class="delete" type="submit" onclick="myFunction()">Delete</button>-->
<!--        <script>-->
<!--          function myFunction() {-->
<!--            alert("Are you sure you want to delete?");-->
<!--          }-->
<!--        </script>-->
        <button class="delete" type="submit"
                onclick="return confirm('Are you sure you want to delete?')">
          Delete
        </button>
      </form>
    </td>
  </tr>
</table>

<p>
  title: <span th:text="${title}"></span>
  genre: <span th:text="${genre}"></span>
  sortBy: <span th:text="${sortBy}"></span>
  direction: <span th:text="${direction}"></span>
</p>

<div>
  <a th:if="${currentPage  > 0}",
  th:href="@{/movies(
  page=${currentPage - 1},
  size=${size},
  genre=${genre},
  sortBy=${sortBy},
  direction=${direction})}">
 <-
  </a>

  <span th:each="i : ${#numbers.sequence(0, totalPages - 1)}">
    <a th:href="@{/moves(
page=${i},
size=${size},
title=${title},
genre=${title},
sortBy=${sortBy},
direction=${direction})}"
    th:text="${i + 1}"
    th:style="${i == currentPage} ? 'font-weight:bold' : ''">

    </a>

  </span>

  <a th:if="${currentPage + 1 < totalPages}",
     th:href="@{/movies(
  page=${currentPage - 1},
  size=${size},
  genre=${genre},
  sortBy=${sortBy},
  direction=${direction})}">
    ->
  </a>
</div>

</body>

<style>
  h1{
  text-align: center;
  margin-right: 30px;
  font-family: 'Funnel-Display', sans-serif;
  }

  table{
  width: 900px;
  height:300px;
  margin: 80px auto 0 auto;
  border: 3px solid black;
  border-radius: 10px;
  border-spacing: 0;
  font-family: 'Funnel-Display', sans-serif;
  }

  td,th{
  border: 1px solid black;
  text-align: center;
  }

  body{
  background-color: #f2f0e6;
  }

  .btn{
    margin-left: 310px;
    position: relative;
    top: 70px;
    justify-content: center;
    display: inline-block;
    padding: 10px 15px;
    background-color: #999999;
    color: white;
    text-decoration: none;
    font-family: 'Funnel-Display', sans-serif;
    border-radius: 8px;
    font-weight: bold;
    transition: 0.3s;
  }

  .btn:hover {
    background-color: #7a7a7a;
  }

  .delete {
    padding: 10px 15px;
    background-color: #ff4d4d; /* red for delete */
    color: white;
    border: none; /* remove default button border */
    border-radius: 8px;
    font-family: 'Funnel-Display', sans-serif;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
}

.delete:hover {
    background-color: #cc0000; /* darker red on hover */
}


  .edit{
    text-decoration: none;
    display: inline-block;
    padding: 10px 15px;
    background-color: #4CAF50;
    color:white;
    border: none;
     border-radius: 8px;
    font-family: 'Funnel-Display', sans-serif;
    font-weight: bold;
    transition: 0.3s;
    cursor: pointer;

   }

  .edit:hover{
  background-color: #006400;
</style>
</html>
